---
title: "Chapter 2: Perfectly Secret Encryption"
date: 2023-08-15T13:49:07+05:30
draft: false
---

1. Note that
\begin{equation}
\pr{C=c\ |\ M=m} = \pr{\textsf{Enc}\brak{m,K}=c}
\label{eq:pr-C-M}
\end{equation}
depends on the distribution of keys in \\(\mathcal{K}\\). Let us redefine the key space to be the set of all random bits used by \\(\textsf{Gen}\\), and call this space \\(\mathcal{K'}\\). Then, each element of \\(\mathcal{K}\\) is uniformly distributed. Further, for any key \\(k \in \mathcal{K}\\),
\begin{equation}
\pr{K=k} = \pr{\textsf{Gen}\brak{K'}=k} = \frac{\abs{\cbrak{k'\in\mathcal{K'}:\textsf{Gen}\brak{k'}=k}}}{\abs{\mathcal{K}}}.
\label{eq:pr-K-K'}
\end{equation}
From \eqref{eq:pr-K-K'}, the probability distribution of \\(K\\) does not change, and hence by choosing the keyspace to be \\(\textsf{K'}\\), the value of \\(\pr{C=c\ |\ M=m}\\) does not change. Thus, we may assume without loss of generality that \\(\textsf{Gen}\\) picks a key from the key space uniformly at random.

2. Assume that \\(\textsf{Enc}\\) is not deterministic. Then, it uses a string \\(b\\) of randomly generated bits. Call this space of bitstrings \\(\mathcal{B}\\). Define a new encryption algorithm \\(\textsf{Enc'}\brak{m, k, b} \triangleq \textsf{Enc}\_b\brak{m, k}\\). Thus, \\(\textsf{Enc'}\\) is deterministic. Hence,
\begin{align}
\pr{C=c\ |\ M=m} &= \pr{\textsf{Enc'}\brak{m, K, B} = c} \\\\
&= \sum_{b \in \mathcal{B}}\pr{\textsf{Enc}\_b\brak{m, K} = c} \\\\
&= \pr{\textsf{Enc}\brak{m, K} = c}.
\label{eq:det-enc}
\end{align}
From \eqref{eq:det-enc}, we see that we can assume \\(\textsf{Enc}\\) to be deterministic without loss of generality.

3. We have, using conditional probability,
\begin{align}
\pr{M=m\ |\ C=c} &= \frac{\pr{M=m,\ C=c}}{\pr{C=c}} \\\\
&= \pr{M=m}\frac{\pr{C=c\ |\ M=m}}{\pr{C=c}}
\label{eq:pr-M-given-C}
\end{align}
and the system is perfectly secure if and only if \\(M\\) and \\(C\\) are independent random variables, which may not be the case. Thus, the given statement is _false_.

4. If the cryptosystem is secure, then we have
\begin{align}
\pr{M=m} &= \pr{M=m\ |\ C=c} \\\\
&= \pr{M=m'\ |\ C=c} \\\\
&= \pr{M = m'}
\end{align}
which is not true for all distributions of \\(\mathcal{M}\\).

5. Suppose that the cryptosystem \\(\Pi\\) is perfectly secure. Then, WLOG for any deterministic adversary \\(\mathcal{A}\\), where \\(\mathcal{C^{\*}} = \cbrak{c \in \mathcal{C}\ |\ \mathcal{A}\brak{c} = 0}\\),
\begin{align}
&\pr{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} \\\\
&= \frac{1}{2}\brak{\pr{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 0} + \pr{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 1}} \\\\
&= \frac{1}{2}\brak{\pr{\mathcal{A} \textrm{ outputs 0}\ |\ b = 0} + \pr{\mathcal{A} \textrm{ outputs 1}\ |\ b = 1}} \\\\
&= \frac{1}{2}\brak{\pr{\mathcal{A}\brak{c} = 0\ |\ M = m\_0} + \pr{\mathcal{A}\brak{c} = 1\ |\ M = m\_1}} \label{eq:perf-sec-use} \\\\
&= \frac{1}{2}\brak{\pr{c \in \mathcal{C^{\*}}} + \pr{c \notin \mathcal{C^{\*}}}} = \frac{1}{2}
\label{eq:perf-sec-privk}
\end{align}
    which proves one direction of the Theorem. To prove the other direction, suppose that the cryptosystem is perfectly indistinguishable. That is, \\(\forall\ \mathcal{A},\ \forall\ m\_0,\ m\_1 \in \mathcal{M},\ \forall\ c \in \mathcal{C}\\),
\begin{equation}
\pr{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} = \frac{1}{2}
\end{equation}
