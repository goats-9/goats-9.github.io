---
title: "Chapter 2: Perfectly Secret Encryption"
date: 2023-08-15T13:49:07+05:30
draft: false
---

1.  Note that

    \begin{equation}
    \pr{C=c\ |\ M=m} = \prs{\textsf{Enc}\brak{m,K}=c}
    \label{eq:pr-C-M}
    \end{equation}

    depends on the distribution of keys in \\(\mathcal{K}\\). Let us redefine
    the key space to be the set of all random bits used by \\(\textsf{Gen}\\),
    and call this space \\(\mathcal{K'}\\). Then, each element of
    \\(\mathcal{K}\\) is uniformly distributed. Further, for any key \\(k \in
    \mathcal{K}\\),

    \begin{equation}
    \pr{K=k} = \prs{\textsf{Gen}\brak{K'}=k} = \frac{\abs{\cbrak{k'\in\mathcal{K'}:\textsf{Gen}\brak{k'}=k}}}{\abs{\mathcal{K}}}.
    \label{eq:pr-K-K'}
    \end{equation}

    From \eqref{eq:pr-K-K'}, the probability distribution of \\(K\\) does not
    change, and hence by choosing the keyspace to be \\(\textsf{K'}\\), the
    value of \\(\pr{C=c\ |\ M=m}\\) does not change. Thus, we may assume without
    loss of generality that \\(\textsf{Gen}\\) picks a key from the key space
    uniformly at random.

2.  Assume that \\(\textsf{Enc}\\) is not deterministic. Then, it uses a string
    \\(b\\) of randomly generated bits. Call this space of bitstrings
    \\(\mathcal{B}\\). Define a new encryption algorithm
    \\(\textsf{Enc'}\brak{m, k, b} \triangleq \textsf{Enc}\_b\brak{m, k}\\).
    Thus, \\(\textsf{Enc'}\\) is deterministic. Hence,

    \begin{align}
    \pr{C=c\ |\ M=m} &= \prs{\textsf{Enc'}\brak{m, K, B} = c} \\\\
    &= \sum_{b \in \mathcal{B}}\prs{\textsf{Enc}\_b\brak{m, K} = c} \\\\
    &= \prs{\textsf{Enc}\brak{m, K} = c}.
    \label{eq:det-enc}
    \end{align}

    From \eqref{eq:det-enc}, we see that we can assume \\(\textsf{Enc}\\) to be
    deterministic without loss of generality.

3.  We have, using conditional probability,

    \begin{align}
    \pr{M=m\ |\ C=c} &= \frac{\pr{M=m,\ C=c}}{\pr{C=c}} \\\\
    &= \pr{M=m}\frac{\pr{C=c\ |\ M=m}}{\pr{C=c}}
    \label{eq:pr-M-given-C}
    \end{align}
    
    and the system is perfectly secure if and only if \\(M\\) and \\(C\\) are
    independent random variables, which may not be the case. Thus, the given
    statement is _false_.

4.  If the cryptosystem is secure, then we have

    \begin{align}
    \pr{M=m} &= \pr{M=m\ |\ C=c} \\\\
    &= \pr{M=m'\ |\ C=c} \\\\
    &= \pr{M = m'}
    \end{align}

    which is not true for all distributions of \\(\mathcal{M}\\).

5.  We can remove the non-determinism from \\(\mathcal{A}\\) by assuming all
    random bits (represented as an \\(n\\)-bitstring \\(s\\)) used are supplied
    as input. Calling the new algorithm \\(\mathcal{A^{\prime}}\\), and defining

    \begin{equation}
    R \triangleq \cbrak{s | \mathcal{A^{\prime}}\brak{c,s} = 1},
    \end{equation}

    we see that, since \\(s\\) is picked uniformly at random from \\(R\\),

    \begin{equation}
    \pr{\mathcal{A^{\prime}}\brak{c,S} = 1} = \frac{\abs{R}}{2^n} = \pr{\mathcal{A}\brak{c} = 1}.
    \end{equation}

6.  Suppose that the cryptosystem \\(\Pi\\) is perfectly secure. Then, WLOG for
    any deterministic adversary \\(\mathcal{A}\\), where \\(\mathcal{C^{\*}}
    \triangleq \cbrak{c \in \mathcal{C}\ |\ \mathcal{A}\brak{c} = 0}\\),

    \begin{align}
    &\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} \\\\
    &= \frac{1}{2}\brak{\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 0} + \prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 1}} \\\\
    &= \frac{1}{2}\brak{\pr{\mathcal{A}\brak{c} = 0\ |\ M = m\_0} + \pr{\mathcal{A}\brak{c} = 1\ |\ M = m\_1}} \label{eq:perf-sec-use} \\\\
    &= \frac{1}{2}\brak{\pr{c \in \mathcal{C^{\*}}} + \pr{c \notin \mathcal{C^{\*}}}} = \frac{1}{2}
    \label{eq:perf-sec-privk}
    \end{align}

    where \eqref{eq:perf-sec-privk} follows from the previous equality by the
    definition of perfect security, which implies that \\(\pr{C=c\ |\ M=m} =
    \pr{C=c}\\). This proves one direction of the Theorem. To prove the other
    direction, suppose that the cryptosystem is perfectly indistinguishable.
    That is, \\(\forall\ \mathcal{A},\ \forall\ m\_0,\ m\_1 \in \mathcal{M},\
    \forall\
    c \in \mathcal{C}\\),

    \begin{align}
    &\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} = \frac{1}{2} \\\\
    &\frac{1}{2}\brak{\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 0} + \prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 1}} = \frac{1}{2} \\\\
    &\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ b = 1} = \prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 0\ |\ b = 0} \\\\
    &\pr{c\in\mathcal{C^{\*}}|M=m\_0} = \pr{c\in\mathcal{C^{\*}}|M=m\_1}.
    \label{eq:privk-perf-sec}
    \end{align}

    Setting an adversary such that \\(\mathcal{C^{\*}} = \cbrak{c\_0}\\), for
    some \\(c\_0 \in C\\), we see from \eqref{eq:privk-perf-sec} that the
    system is perfectly secure.

7.  The resulting ciphertext is \\(\texttt{0x012345} \oplus \texttt{0xFFEEDD} =
    \texttt{0xFECD98}\\).

8.  1.  We have,
    
        \begin{align}
        \pr{M=m\ |\ C=c} &= \prs{\textsf{Dec}\brak{c,K} = m} \\\\
        &= \pr{\brak{c-K}\bmod 5 = m} \\\\
        &= 
        \begin{cases}
            \frac{1}{3} & c = m \\\\
            \frac{1}{6} & c \neq m
        \end{cases}
        \label{eq:pr-M-given-C-mod}
        \end{align}

        since \\(K\random\mathcal{K}\\). Setting \\(M\random\mathcal{M}\\), we
        see that the cryptosystem is insecure as \\(\pr{M=m\ |\ C=c} \neq
        \pr{M=m}\ \forall\ m\in\mathcal{M},\ c\in\mathcal{C}\\).
    
    2.  We can distinguish messages based on their last bit, since it is
        retained in the ciphertext. Thus, the given cryptosystem is insecure.

9.  1.  Note that \\(\pr{M=0\ |\ C=2} = 0\\). Thus, by selecting
        \\(M\random\mathcal{M}\\), we see that the cryptosystem is insecure.
    
    2.  We have, for some \\(m\_0\in\mathcal{M},\ c\_0\in\mathcal{C}\\), and
        since \\(K\random\mathcal{K}\\),

        \begin{align} 
            \pr{M=m\_0\ |\ C=c\_0} &= \frac{\pr{C=c\_0\ |\ M=m\_0}\pr{M=m\_0}}{\sum\_{m\in\mathcal{M}}\pr{C=c\_0\ |\ M=m}\pr{M=m}} \\\\
            &= \frac{\pr{K=\brak{c\_0-m\_0}\bmod 3}\pr{M=m\_0}}{\sum\_{m\in\mathcal{M}}\pr{K=\brak{c\_0-m}\bmod 3}\pr{M=m}} \\\\
            &= \frac{\frac{1}{3}\pr{M=m}}{\frac{1}{3}\sum\_{m\in\mathcal{M}}\pr{M=m}} = \pr{M=m\_0}.
            \label{eq:mod-3-perf-sec}
        \end{align}

        Therefore, the given system is perfectly secure.
    
    3.  For the given spaces, we see that \eqref{eq:mod-3-perf-sec} still holds
        as the key space contains the complete set of residues modulo 3.

10. 1.  For some \\(m\_0\in\mathcal{M},\ c\_0\in\mathcal{C},\ \abs{m\_0} =
        \abs{c\_0}\\), we have
        
        \begin{equation}
            \pr{C=c\_0\ |\ M=m\_0} = \pr{K\_{\abs{m\_0}} = m\_0} = 2^{-\abs{m\_0}}
        \end{equation}

        and

        \begin{align}
            \pr{C=c\_0} &= \sum\_{m}\pr{C=c\_0\ |\ M=m}\pr{M=m} \\\\
            &= \sum\_{m\ :\ \abs{m}=\abs{m\_0}}2^{-\abs{m\_0}}\pr{M=m} < 2^{-\abs{m\_0}}.
        \end{align}
        
        Hence, the given cryptosystem is insecure.
    
    2.  Set \\(\mathcal{K} = \mathcal{M}\\) and define \\(n\brak{m}\\) to be the
        lexicographical ranking of \\(m\\) in \\(\mathcal{M}\\). Then, define

        \begin{equation}
            \textsf{Enc}\brak{m,k} \triangleq \brak{n\brak{m}+n\brak{k}}\bmod 2^l.
        \end{equation}

        This is perfectly secure as it is essentially the OTP scheme with
        residues modulo \\(2^l\\).

11. We have,

    \begin{align}
        \pr{M=m\ |\ C=c} &= \prs{\textsf{Dec}\brak{c,K} = m} \\\\
        &= \pr{K = c\oplus m} =
        \begin{cases}
            0 & m = c \\\\
            \frac{1}{2^l-1} & m \neq c
        \end{cases}
    \end{align}
    
    and by setting \\(M\random\mathcal{M}\\), we see that the cryptosystem is
    insecure.

12. Since \\(t=2\\), the first and last characters are always offset by the same
    amount. Thus, the given adversary \\(\mathcal{A}\\) will always guess the
    encrypted message correctly. Thus,
    \\(\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} = 1\\).

13. 1.  Observe that if \\(t=1\\), then \\(\mathcal{A}\\) will always guess
        correctly. Otherwise for \\(t>1\\), if \\(m\_0\\) is encrypted, the
        first two letters of the key must be the same, which occurs with a
        probability of \\(\frac{1}{26}\\). If \\(m\_1\\) is encrypted instead,
        then the first letter must not be one more than the second letter, which
        happens with probability \\(\frac{25}{26}\\). Putting this together,

        \begin{align}
            \prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} &= \sum\_{i=1}^3\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ t=i}\pr{t=i} \\\\
            &= \frac{1}{3}\brak{1 + 2\brak{\frac{1}{2}}\brak{\frac{1}{26}+\frac{25}{26}}} = \frac{2}{3}.
        \end{align}

    2. Define \\(\mathcal{A}^\prime\\) as follows: \\(\mathcal{A}^\prime\\)
       outputs \\(m\_0 = \texttt{aaa}\\) and \\(m\_1 = \texttt{aab}\\). When
       given a ciphertext \\(c\\), it outputs 0 if the first and last characters
       of \\(c\\) are equal, and outputs 1 otherwise. Notice that
       \\(\mathcal{A}^\prime\\) will distinguish these messages for keys with
       \\(t\le2\\). Thus, using the same argument as before,

        \begin{align}
            \prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} &= \sum\_{i=1}^3\prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1\ |\ t=i}\pr{t=i} \\\\
            &= \frac{1}{3}\brak{1 + 1 + \frac{1}{2}\brak{\frac{1}{26}+\frac{25}{26}}} = \frac{5}{6} > \frac{2}{3}.
        \end{align}

14. 1.  If a single character is encrypted, then the shift cipher is given by

        \begin{equation}
            \textsf{Enc}\brak{m,k} = \brak{m+k}\bmod n
        \end{equation}

        where \\(n\\) is the length of the alphabet. This is clearly a secure
        cipher.
    
    2.  For messages of length greater than 1, we can perfectly distinguish
        messages of the form \\(m\_0 = \texttt{aa\ldots}\\) and \\(m\_1 =
        \texttt{ab\ldots}\\) by checking if the first two characters are the
        same or not. Thus, we must have \\(\mathcal{M} = \Sigma\\).
    
    3.  This situation is the same as using a One Time Pad for messages of
        length \\(t\\), hence it is perfectly secure.

15. Define \\(\mathcal{A}\\) as follows: \\(\mathcal{A}\\) outputs two random
    unequal strings \\(m\_0\\) and \\(m\_1\\) from \\(\mathcal{M}\\). When it
    receives \\(c\\), it computes
    
    \begin{equation}
        \mathcal{M}\brak{c} \triangleq \cbrak{\textsf{Dec}\brak{c,k}\ :\ k\in\mathcal{K}}.
    \end{equation}

    \\(\mathcal{A}\\) then checks if \\(m\_0\\) and \\(m\_1\\) are split by
    \\(\mathcal{M}\brak{c}\\). If so, it outputs \\(b^\prime\\) where
    \\(m\_b\in\mathcal{M}\brak{c}\\). Otherwise, it guesses \\(b^\prime\\)
    randomly. Suppose the probability of this split occurring be \\(p\\). Then,

    \begin{equation}
        \prs{\textsf{PrivK}\_{\mathcal{A},\Pi}^{\textsf{eav}} = 1} = p + \frac{1-p}{2} = \frac{1+p}{2} > \frac{1}{2}
    \end{equation}

    as required.

16. 1.  Let the characters be \\(m\_1\\) and \\(m\_2\\). Then, \\(m\_1 \oplus
        m\_2 = 0101\ 0000\\). Thus, these characters differ in their fourth and
        sixth bit in their ASCII representations only. We can determine all
        possible pairs with an \\(\mathcal{O\brak{\abs{M}}}\\) search using
        hashing.
    
    2.  Let the characters be \\(m\_1,\ m\_2, m\_3\\). Then, we obtain
    
        \begin{align}
            m\_1 \oplus m\_2 &= 0101\ 0100 \\\\
            m\_2 \oplus m\_3 &= 0001\ 0001 \\\\
            m\_3 \oplus m\_1 &= 0100\ 0101.
        \end{align}

        Further, the second, fourth and sixth bits of the characters in ASCII
        representation are equal. Again, we can determine such pairs in
        \\(\mathcal{O\brak{\abs{M}}}\\).

17. 
        
        
        
        
        
        

        

        
        
        

        
        
        
        